<?php 
include($_SERVER['DOCUMENT_ROOT'].'/header.php');
include("security.php");
include("security_level_check.php");
include("functions_external.php");

function htmli($data)
{
         
    switch($_COOKIE["security_level"])
    {
        
        case "0" : 
            
            $data = no_check($data);            
            break;
        
        default : 
            
            $data = no_check($data);            
            break;  

    }       

    return $data;

}

?>
<div id="main">
    
    <h1>HTML Injection - Reflected (POST)</h1>

    <p>Enter your first and last name:</p>

    <form action="<?php echo($_SERVER["SCRIPT_NAME"]);?>" method="POST">

        <input type="text" id="firstname" name="firstname" placeholder="firstname">
        <input type="text" id="lastname" name="lastname" placeholder="lastname">

        <button type="submit" name="form" value="submit">Go</button>  

    </form>

    <br />
    <?php

    if(isset($_POST["firstname"]) && isset($_POST["lastname"]))
    {   

        $firstname = $_POST["firstname"];
        $lastname = $_POST["lastname"];    

        if($firstname == "" or $lastname == "")
        {

            echo "<font color=\"red\">Please enter both fields...</font>";

        }

        else            
        {

            echo "Welcome " . htmli($firstname) . " " .  htmli($lastname);

        }

    }

    ?>

</div>
 
<?php include($_SERVER['DOCUMENT_ROOT'].'/footer.php'); ?>